<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.js"></script>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="/resource/css/home/home.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <link href="/resource/bootstrap-4.6.0-dist/css/bootstrap.min.css" rel="stylesheet" type="text/css" id="bootstrap-stylesheet">
    <link rel="stylesheet" href="/resource/font-awesome-4.7.0/css/font-awesome.css">
    <link rel="stylesheet" href="/resource/css/style.css">
</head>
<body>
<!--preloader-->
<div id='af-preloader'>
    <div class='af-preloader-wrap'>
        <div class='af-sp af-sp-wave'></div>
    </div>
</div>
<!--end-->
<div class="wrapper">
    <!-- Sidebar  -->
    <nav id="sidebar" >
        <div class="sidebar-header">
            <img src="/resource/img/01.jpg" style="border-radius:50%; width: 100px; height: 100px">
            <h3>RESTAURANT</h3>
        </div>
        <ul class="list components">
            <li class="active">
                 <ul style="list-style-type: none !important;">
                    <li>
                        <a href="/admin" class="alert alert-danger" role="alert">
                            Trang quản lý
                        </a>
                    </li>
                    <li>
                        <a href="/profile" class="alert alert-danger" role="alert">
                            Cá nhân
                        </a>
                    </li>
                    <li>
                        <a href="javascript:;" class="alert alert-danger" role="alert" onclick="report.openModal()">
                            Báo cáo
                        </a>
                    </li>
                    <li>
                        <a href="javascript:;" class="alert alert-danger" role="alert" onclick="notification.openModal()">
                            Xem Thông báo
                        </a>
                    </li>
                    <li>
                        <a href="/logout" class="alert alert-danger" role="alert" >
                            Thoát
                        </a>
                    </li>
                </ul>
            </li>
        </ul>
    </nav>
</div>
    <!-- Page Content  -->
<form>
    Danh mục món ăn
    <div id="category">

    </div>
</form>
<table id="basic-datatable" class="table dt-responsive nowrap">
    <thead>
    <tr>
        <th>Id</th>
        <th>Món ăn</th>
        <th>Giá</th>
        <th>Action</th>
    </tr>
    </thead>
    <tbody id="tbListProduct">
    </tbody>
</table>
<script src="/resource/js/jquery-3.6.0.min.js"></script>
<script src="/resource/bootstrap-4.6.0-dist/js/bootstrap.bundle.min.js"></script>
<script src="/resource/bootstrap-4.6.0-dist/js/bundle.js"></script>
<script src="/resource/bootstrap-4.6.0-dist/js/bootstrap.js"></script>

<script src="/resource/js/sweetalert2.min.js"></script>
<script src="/resource/page/js/app.js"></script>
<!--validator-->
<script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.1/jquery.validate.min.js"></script>
<!--bootbox-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/5.5.2/bootbox.min.js"></script>
<!--Notify-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/notify/0.4.2/notify.min.js" integrity="sha512-efUTj3HdSPwWJ9gjfGR71X9cvsrthIA78/Fvd/IN+fttQVy7XWkOAXb295j8B3cmm/kFKVxjiNYzKw9IQJHIuQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<!-- jQuery CDN - Slim version (=without AJAX) -->
<!-- Popper.JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
<!-- Bootstrap JS -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
<!-- jQuery Custom Scroller CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/malihu-custom-scrollbar-plugin/3.1.5/jquery.mCustomScrollbar.concat.min.js"></script>

<!--Jquery-->
<script type="text/javascript">
    <!--    template-->
    $(document).ready(function () {
        $('#af-preloader').delay(500).fadeOut('slow')

        $('#sidebarCollapse').on('click', function () {
            $('#sidebar, #content').toggleClass('active');
            $('.collapse.in').toggleClass('in');
            $('a[aria-expanded=true]').attr('aria-expanded', 'false');
        });
    });
</script>
<script>
    function SelectProduct() {
        $("form div").on("click", ".category", function () {
            let id = $(this).data("id");

            $.ajax({
                headers: {
                    'Accept':'application/json',
                    'Content-Type':'application/json'
                },
                url: "/api/product/category/" + id,
                type: "GET"
            }).done(function (resp) {
                let str = '';
                $("#tbListProduct tr").remove();
                $.each(resp, function(index, item) {

                    str = `
                        <tr id="tr_${item.id}">
                            <th scope="row">${item.id}</th>
                            <td>${item.name}</td>
                            <td>${item.price}</td>
                            <td>
                                <button type="button" data-toggle="modal" data-target="#updateModal" class="btn btn-outline-primary plus"
                                    data-id="${item.id}">
                                    <i class="fa fa-plus-square"></i>
                                </button>
                            </td>
                            <td>
                                <button type="button" class="btn btn-outline-danger minus" data-id="${item.id}">
                                    <i class="fa fa-minus-square"></i>
                                </button>
                            </td>

                        </tr>
                    `;

                    $("#tbListProduct").prepend(str);
                });

            }).fail(function () {
                alert("ERROR")
            });
        })
    }

    function getListProduct() {
        $.ajax({
            url: "/api/product",
            type: "GET"
        }).done(function (resp) {

            let str = '';

            $.each(resp, function(index, item) {

                str = `
                        <tr id="tr_${item.id}">
                            <th scope="row">${item.id}</th>
                            <td>${item.name}</td>
                            <td>${item.price}</td>
                            <td>
                                <button type="button" class="btn btn-outline-primary plus"
                                    data-id="${item.id}">
                                    Chọn món
                                </button>
                            </td>

                        </tr>
                    `;
                $("#tbListProduct").prepend(str);
            });


            handleEdit();

            handleDelete();

        }).fail(function () {
            alert("ERROR")
        });
    }

    function getAllCategory() {
        return $.ajax({
            url: "/api/category",
            type: "GET"
        }).done(function (resp) {

            let str = '';

            $.each(resp, function(index, item) {
                str = `
                    <button type="button" class="btn btn-outline-primary category" data-id="${item.id}">
                    ${item.name}</button>
                `;
                $("#category").prepend(str);
            })
        }).fail(function () {
            alert("ERROR")
        });
    }

    $(document).ready(function () {
        getAllCategory();
        getListProduct();
        SelectProduct();
    });
</script>
</body>
</html>